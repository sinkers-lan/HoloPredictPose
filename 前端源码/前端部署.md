# HoloPredictPose



## 前言

在这个项目中，我们运用Hololens2的传感器实时获取人体图像数据，传输给后端进行人体姿态预测模型的处理。同时，我们基于unity进行开发，将unity部署到Hololens2上，以便于观察人体真实动作与模型预测动作的实时效果。
本文的配置将实现把Hololens2设备上的图像数据通过wifi实时地传递到电脑端，方便用深度学习算法对图像进行处理，同时，实现unity动作效果的实时展示。



## 安装工具

1. **Windows10 或 Windows11操作系统**

2. **一台Hololens2头戴显示设备**

3. **WIN SDK（最新版）**

4. **UnityHub & Unity 2020.3.45  [**[下载地址](https://unity.cn/releases/full/2020)**]**

5. **Visual Studio 2022 [**[下载地址](https://visualstudio.microsoft.com/zh-hans/)**]**

   **必备插件：**

   ![1](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/1.png)



## 前端项目使用说明

### Unity环境配置与资源导入

①官网下载unity hub

②在hub内下载unity2020.3版本，需要勾选以下模块：

![image-20230427125427514](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427125427514.png)

③新建unity3Dcore项目，项目名称可以指定为HoloPredictPose

![image-20230427125705194](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427125705194.png)

④“资源”——“导入包”——“自定义包”，导入HoloPredict.unitypackage

⑤“窗口”——“包管理器”，左上角拉选“Unity注册表”，分别搜索并下载以下三个包：Collections、Animation Rigging、Newtonsoft Json

![image-20230427130855228](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427130855228.png)

⑥观察控制台没有编译错误，则导入成功



### Unity配置测试

基于上述步骤，在两个人物控件的/rig/offset的右侧信息栏中分别引入out0.json和out1.json，**并勾选“Use Local Json”选项**

（该选项可以使得人物按照引入json文件中的3D关键点数据做出相应动作），如图：
![10](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/10.png)
![11](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/11.png)
配置成功后，点击上方三角按钮，观察任务动作变化，若画面中人物动作正常变化，则项目搭建成功，可以进入下一步“将Unity项目部署到Hololens2”。



### 生成与运行

*以下操作的目的是将配置好的项目编译并导入到Hololens2眼镜中

①导入混合现实工具包MRTK，参考教程 [[MRTK导入-参考教程](https://learn.microsoft.com/zh-cn/training/modules/learn-mrtk-tutorials/1-5-exercise-configure-resources?ns-enrollment-type=learningpath&ns-enrollment-id=learn.azure.beginner-hololens-2-tutorials&tabs=openxr)]，完成`导入 MRTK Unity 基础包`小结。

②在“文件”->“生成设置”（File->Build Settings）中，左侧选择”Universal Windows Platform“，点击”切换平台“。然后依次选择以下配置：

![image-20230427153012542](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427153012542.png)

③点击”玩家设置“（File->Project Settings->Player）

3.1 更改包名，也可以使用默认报名但不建议，此步骤是为了防止相同包名的应用相互覆盖

![image-20230427153522220](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427153522220.png)

3.2 在Capability中选择以下选项，该步骤的目的使得应用获取网络传输等权限，已经勾选的选项不用取消勾选：

![image-20230427153644030](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427153644030.png)

![image-20230427154422842](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230427154422842.png)

④为dll库更改平台设置如下：

![image-20230428134422848](https://sinkers-pic.oss-cn-beijing.aliyuncs.com/img/image-20230428134422848.png)

